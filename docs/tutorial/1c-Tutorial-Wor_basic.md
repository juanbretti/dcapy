# WOR Forecasting

In this section is introduced the basic classes and functions to make Forecast by applying the Wor Methodology 


```python
import os
from dcapy import dca
import numpy as np 
```

The WOR forecasting is an empirical method to estimate the trend of the water production with respect the cumulative oil production. 


Generally you can determine the WOR (Water-Oil Ratio) vs the Np (Cumulative Oil Production) linear relationship on a semi-log plot when preducing at a constant rate of total fluids.

$$
 WOR = \frac{q_{w}}{q_{o}}
$$

## Simple Functions to convert Bsw to Wor



```python
list_bsw = [0.01,0.01,0.1,0.5,0.8,0.9,0.95,0.99]

list_wor = dca.bsw_to_wor(list_bsw)
```


```python
dca.wor_to_bsw(list_wor)
```




    array([0.01, 0.01, 0.1 , 0.5 , 0.8 , 0.9 , 0.95, 0.99])



## Wor Forecasting function

The parameters required to define a WOR model are:

+ **Slope**: It is the relationship between the WOR and Np. It is defined as $\frac{d(log(WOR))}{d Np}$
+ **Fluid Rate**: Total fluid rate production target
+ **Ti**: Initial Time
+ **WOR initial**: The Wor value at the initial time


```python
time1 = np.arange(0,10,1)
slope = 3e-6
bswi = 0.5
wori = dca.bsw_to_wor(bswi)
fluid_rate = [5000]*10

f1 = dca.wor_forecast(time1,fluid_rate,slope,wori)
print(f1)

```

             oil_rate   water_rate       oil_cum     water_cum       bsw  \
    date                                                                   
    0     2500.000000  2500.000000   2500.000000   2500.000000  0.500000   
    1     2490.625044  2509.374956   4990.625044   5009.374956  0.501875   
    2     2481.285506  2518.714494   7471.910550   7528.089450  0.503743   
    3     2471.981509  2528.018491   9943.892058  10056.107942  0.505604   
    4     2462.713170  2537.286830  12406.605228  12593.394772  0.507457   
    5     2453.480601  2546.519399  14860.085829  15139.914171  0.509304   
    6     2444.283905  2555.716095  17304.369734  17695.630266  0.511143   
    7     2435.123183  2564.876817  19739.492917  20260.507083  0.512975   
    8     2425.998526  2574.001474  22165.491443  22834.508557  0.514800   
    9     2416.910022  2583.089978  24582.401465  25417.598535  0.516618   
    
               wor     wor_1  delta_time  fluid_rate  fluid_cum  
    date                                                         
    0     1.000000  2.000000         1.0        5000     5000.0  
    1     1.007528  2.007528         1.0        5000    10000.0  
    2     1.015085  2.015085         1.0        5000    15000.0  
    3     1.022669  2.022669         1.0        5000    20000.0  
    4     1.030281  2.030281         1.0        5000    25000.0  
    5     1.037921  2.037921         1.0        5000    30000.0  
    6     1.045589  2.045589         1.0        5000    35000.0  
    7     1.053284  2.053284         1.0        5000    40000.0  
    8     1.061007  2.061007         1.0        5000    45000.0  
    9     1.068757  2.068757         1.0        5000    50000.0  


In this case you have to pass an array with the desired rate whose length be equal to the time array. That means you can pass a fluid rate array with different values.


```python
time1 = np.arange(0,10,1)
slope = 3e-5
bswi = 0.5
wori = dca.bsw_to_wor(bswi)
fluid_rate = [5000]*5 + [6000]*5

f1 = dca.wor_forecast(time1,fluid_rate,slope,wori)
print(f1)
```

             oil_rate   water_rate       oil_cum     water_cum       bsw  \
    date                                                                   
    0     2500.000000  2500.000000   2500.000000   2500.000000  0.500000   
    1     2406.293921  2593.706079   4906.293921   5093.706079  0.518741   
    2     2316.345424  2683.654576   7222.639345   7777.360655  0.536731   
    3     2230.205766  2769.794234   9452.845111  10547.154889  0.553959   
    4     2147.874995  2852.125005  11600.720106  13399.279894  0.570425   
    5     2483.173555  3516.826445  14083.893662  16916.106338  0.586138   
    6     2375.487941  3624.512059  16459.381602  20540.618398  0.604085   
    7     2274.018964  3725.981036  18733.400566  24266.599434  0.620997   
    8     2178.506150  3821.493850  20911.906716  28088.093284  0.636916   
    9     2088.660154  3911.339846  23000.566869  31999.433131  0.651890   
    
               wor     wor_1  delta_time  fluid_rate  fluid_cum  
    date                                                         
    0     1.000000  2.000000         1.0        5000     5000.0  
    1     1.077884  2.077884         1.0        5000    10000.0  
    2     1.158573  2.158573         1.0        5000    15000.0  
    3     1.241946  2.241946         1.0        5000    20000.0  
    4     1.327882  2.327882         1.0        5000    25000.0  
    5     1.416263  2.416263         1.0        6000    31000.0  
    6     1.525797  2.525797         1.0        6000    37000.0  
    7     1.638500  2.638500         1.0        6000    43000.0  
    8     1.754181  2.754181         1.0        6000    49000.0  
    9     1.872655  2.872655         1.0        6000    55000.0  


## Wor Class

Like Arps class, the Wor class have the same advantages described before. In this case you can pass the initial bsw directly so it internally will convert it to WOR value. 


```python
bsw = 0.5
slope = 3.5e-6
ti =  0
fluid = 1000
w1 = dca.Wor(bsw=bsw,slope=slope,ti=ti, fluid_rate = fluid)

print(type(w1))
```

    <class 'dcapy.dca.wor.Wor'>


The forecast method is also present with the same parameters as seen in Arps class


```python
fr = w1.forecast(
    start = 0,
    end = 5,
)
print(fr)
```

            oil_rate  water_rate      oil_cum    water_cum       bsw       wor  \
    date                                                                         
    0     500.000000  500.000000   500.000000   500.000000  0.500000  1.000000   
    1     499.562500  500.437500   999.562500  1000.437500  0.500437  1.001752   
    2     499.125384  500.874616  1498.687884  1501.312116  0.500875  1.003505   
    3     498.688651  501.311349  1997.376535  2002.623465  0.501311  1.005259   
    4     498.252303  501.747697  2495.628838  2504.371162  0.501748  1.007015   
    
             wor_1  delta_time  fluid_rate  fluid_cum  iteration  oil_volume  \
    date                                                                       
    0     2.000000         1.0      1000.0     1000.0          0  499.562500   
    1     2.001752         1.0      1000.0     2000.0          0  499.343942   
    2     2.003505         1.0      1000.0     3000.0          0  498.907017   
    3     2.005259         1.0      1000.0     4000.0          0  498.470477   
    4     2.007015         1.0      1000.0     5000.0          0  498.252303   
    
          water_volume  gas_cum  gas_volume  gas_rate  
    date                                               
    0       500.437500        0           0         0  
    1       500.656058        0           0         0  
    2       501.092983        0           0         0  
    3       501.529523        0           0         0  
    4       501.747697        0           0         0  


If you want to change the fluid rate you can pass a different value when calling the `forecast` method


```python
fr = w1.forecast(
    start = 0,
    end = 10,
    fluid_rate = 2000
)
print(fr)
```

             oil_rate   water_rate      oil_cum     water_cum       bsw       wor  \
    date                                                                            
    0     1000.000000  1000.000000  1000.000000   1000.000000  0.500000  1.000000   
    1      998.250002  1001.749998  1998.250002   2001.749998  0.500875  1.003506   
    2      996.503077  1003.496923  2994.753079   3005.246921  0.501748  1.007018   
    3      994.759230  1005.240770  3989.512309   4010.487691  0.502620  1.010537   
    4      993.018467  1006.981533  4982.530776   5017.469224  0.503491  1.014061   
    5      991.280792  1008.719208  5973.811568   6026.188432  0.504360  1.017592   
    6      989.546211  1010.453789  6963.357778   7036.642222  0.505227  1.021128   
    7      987.814727  1012.185273  7951.172505   8048.827495  0.506093  1.024671   
    8      986.086346  1013.913654  8937.258851   9062.741149  0.506957  1.028220   
    9      984.361072  1015.638928  9921.619923  10078.380077  0.507819  1.031775   
    
             wor_1  delta_time  fluid_rate  fluid_cum  iteration  oil_volume  \
    date                                                                       
    0     2.000000         1.0      2000.0     2000.0          0  998.250002   
    1     2.003506         1.0      2000.0     4000.0          0  997.376539   
    2     2.007018         1.0      2000.0     6000.0          0  995.631153   
    3     2.010537         1.0      2000.0     8000.0          0  993.888848   
    4     2.014061         1.0      2000.0    10000.0          0  992.149630   
    5     2.017592         1.0      2000.0    12000.0          0  990.413501   
    6     2.021128         1.0      2000.0    14000.0          0  988.680469   
    7     2.024671         1.0      2000.0    16000.0          0  986.950537   
    8     2.028220         1.0      2000.0    18000.0          0  985.223709   
    9     2.031775         1.0      2000.0    20000.0          0  984.361072   
    
          water_volume  gas_cum  gas_volume  gas_rate  
    date                                               
    0      1001.749998        0           0         0  
    1      1002.623461        0           0         0  
    2      1004.368847        0           0         0  
    3      1006.111152        0           0         0  
    4      1007.850370        0           0         0  
    5      1009.586499        0           0         0  
    6      1011.319531        0           0         0  
    7      1013.049463        0           0         0  
    8      1014.776291        0           0         0  
    9      1015.638928        0           0         0  


## Multiple Values

You can create Wor instances with multiple values on each of the parameters. This will create additional iterations accorging with the number of cases and the broadcast shape


```python
bsw = [0.4,0.5,0.6]
slope = 3.5e-6
ti =  0
fluid = 1000
w2 = dca.Wor(bsw=bsw,slope=slope,ti=ti, fluid_rate = fluid)

fr = w2.forecast(
    start = 0,
    end = 4,
    fluid_rate = 2000
)
print(fr)
```

             oil_rate   water_rate      oil_cum    water_cum       bsw       wor  \
    date                                                                           
    0     1200.000000   800.000000  1200.000000   800.000000  0.400000  0.666667   
    1     1197.983156   802.016844  2397.983156  1602.016844  0.401008  0.669473   
    2     1195.968028   804.031972  3593.951184  2406.048816  0.402016  0.672286   
    3     1193.954637   806.045363  4787.905821  3212.094179  0.403023  0.675106   
    0     1000.000000  1000.000000  1000.000000  1000.000000  0.500000  1.000000   
    1      998.250002  1001.749998  1998.250002  2001.749998  0.500875  1.003506   
    2      996.503077  1003.496923  2994.753079  3005.246921  0.501748  1.007018   
    3      994.759230  1005.240770  3989.512309  4010.487691  0.502620  1.010537   
    0      800.000000  1200.000000   800.000000  1200.000000  0.600000  1.500000   
    1      798.656377  1201.343623  1598.656377  2401.343623  0.600672  1.504206   
    2      797.315766  1202.684234  2395.972143  3604.027857  0.601342  1.508416   
    3      795.978163  1204.021837  3191.950306  4808.049694  0.602011  1.512632   
    
             wor_1  delta_time  fluid_rate  fluid_cum  iteration   oil_volume  \
    date                                                                        
    0     1.666667         1.0      2000.0     2000.0          0  1197.983156   
    1     1.669473         1.0      2000.0     4000.0          0  1196.975592   
    2     1.672286         1.0      2000.0     6000.0          0  1194.961333   
    3     1.675106         1.0      2000.0     8000.0          0  1193.954637   
    0     2.000000         1.0      2000.0     2000.0          1   998.250002   
    1     2.003506         1.0      2000.0     4000.0          1   997.376539   
    2     2.007018         1.0      2000.0     6000.0          1   995.631153   
    3     2.010537         1.0      2000.0     8000.0          1   994.759230   
    0     2.500000         1.0      2000.0     2000.0          2   798.656377   
    1     2.504206         1.0      2000.0     4000.0          2   797.986072   
    2     2.508416         1.0      2000.0     6000.0          2   796.646965   
    3     2.512632         1.0      2000.0     8000.0          2   795.978163   
    
          water_volume  gas_cum  gas_volume  gas_rate  
    date                                               
    0       802.016844        0           0         0  
    1       803.024408        0           0         0  
    2       805.038667        0           0         0  
    3       806.045363        0           0         0  
    0      1001.749998        0           0         0  
    1      1002.623461        0           0         0  
    2      1004.368847        0           0         0  
    3      1005.240770        0           0         0  
    0      1201.343623        0           0         0  
    1      1202.013928        0           0         0  
    2      1203.353035        0           0         0  
    3      1204.021837        0           0         0  


As the each case of fluid rate can be an array with multiple values, you can pass a 2D array to make more than one iteration.


```python
bsw = 0.4
slope = 3.5e-6
ti =  0
fluid = [[1000],[2000]]
w3 = dca.Wor(bsw=bsw,slope=slope,ti=ti, fluid_rate = fluid)

fr = w3.forecast(
    start = 0,
    end = 4,
)
print(fr)
```

             oil_rate  water_rate      oil_cum    water_cum       bsw       wor  \
    date                                                                          
    0      600.000000  400.000000   600.000000   400.000000  0.400000  0.666667   
    1      599.495894  400.504106  1199.495894   800.504106  0.400504  0.668068   
    2      598.992002  401.007998  1798.487896  1201.512104  0.401008  0.669471   
    3      598.488324  401.511676  2396.976220  1603.023780  0.401512  0.670876   
    0     1200.000000  800.000000  1200.000000   800.000000  0.400000  0.666667   
    1     1197.983156  802.016844  2397.983156  1602.016844  0.401008  0.669473   
    2     1195.968028  804.031972  3593.951184  2406.048816  0.402016  0.672286   
    3     1193.954637  806.045363  4787.905821  3212.094179  0.403023  0.675106   
    
             wor_1  delta_time  fluid_rate  fluid_cum  iteration   oil_volume  \
    date                                                                        
    0     1.666667         1.0      1000.0     1000.0          0   599.495894   
    1     1.668068         1.0      1000.0     2000.0          0   599.243948   
    2     1.669471         1.0      1000.0     3000.0          0   598.740163   
    3     1.670876         1.0      1000.0     4000.0          0   598.488324   
    0     1.666667         1.0      2000.0     2000.0          1  1197.983156   
    1     1.669473         1.0      2000.0     4000.0          1  1196.975592   
    2     1.672286         1.0      2000.0     6000.0          1  1194.961333   
    3     1.675106         1.0      2000.0     8000.0          1  1193.954637   
    
          water_volume  gas_cum  gas_volume  gas_rate  
    date                                               
    0       400.504106        0           0         0  
    1       400.756052        0           0         0  
    2       401.259837        0           0         0  
    3       401.511676        0           0         0  
    0       802.016844        0           0         0  
    1       803.024408        0           0         0  
    2       805.038667        0           0         0  
    3       806.045363        0           0         0  



```python
bsw = 0.4
slope = 3.5e-6
ti =  0
fluid = [[1000,1200,1300,1250],[2000,2200,2300,2250]]
w4 = dca.Wor(bsw=bsw,slope=slope,ti=ti, fluid_rate = fluid)

fr = w4.forecast(
    start = 0,
    end = 4,
)
print(fr)
```

             oil_rate  water_rate      oil_cum    water_cum       bsw       wor  \
    date                                                                          
    0      600.000000  400.000000   600.000000   400.000000  0.400000  0.666667   
    1      719.395073  480.604927  1319.395073   880.604927  0.400504  0.668068   
    2      778.558558  521.441442  2097.953631  1402.046369  0.401109  0.669752   
    3      747.795540  502.204460  2845.749171  1904.250829  0.401764  0.671580   
    0     1200.000000  800.000000  1200.000000   800.000000  0.400000  0.666667   
    1     1317.781471  882.218529  2517.781471  1682.218529  0.401008  0.669473   
    2     1375.131387  924.868613  3892.912859  2607.087141  0.402117  0.672567   
    3     1342.632470  907.367530  5235.545329  3514.454671  0.403274  0.675812   
    
             wor_1  delta_time  fluid_rate  fluid_cum  iteration   oil_volume  \
    date                                                                        
    0     1.666667         1.0      1000.0     1000.0          0   719.395073   
    1     1.668068         1.0      1200.0     2200.0          0   748.976815   
    2     1.669752         1.0      1300.0     3500.0          0   763.177049   
    3     1.671580         1.0      1250.0     4750.0          0   747.795540   
    0     1.666667         1.0      2000.0     2000.0          1  1317.781471   
    1     1.669473         1.0      2200.0     4200.0          1  1346.456429   
    2     1.672567         1.0      2300.0     6500.0          1  1358.881929   
    3     1.675812         1.0      2250.0     8750.0          1  1342.632470   
    
          water_volume  gas_cum  gas_volume  gas_rate  
    date                                               
    0       480.604927        0           0         0  
    1       501.023185        0           0         0  
    2       511.822951        0           0         0  
    3       502.204460        0           0         0  
    0       882.218529        0           0         0  
    1       903.543571        0           0         0  
    2       916.118071        0           0         0  
    3       907.367530        0           0         0  



```python

```
